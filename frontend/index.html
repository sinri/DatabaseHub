<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Database Hub</title>
    <link rel="stylesheet" href="./static/libs/iview@3.1.5/iview.css">
    <link rel="stylesheet" href="./static/styles/common.css">
    <link rel="stylesheet" href="./static/styles/index.css">
</head>
<body>
<div id="app">
    <header>
        <top-banner></top-banner>
    </header>
    <main>
        <router-view></router-view>
    </main>
</div>
<!--Libs-->
<script src="./static/libs/axios@0.18.0/axios.min.js"></script>
<script src="./static/libs/js-cookie@2.2.0/js.cookie.js"></script>
<script src="./static/libs/vue@2.5.17/vue.min.js"></script>
<script src="./static/libs/vue-router@3.0.2/vue-router.min.js"></script>
<script src="./static/libs/iview@3.1.5/iview.min.js"></script>
<script src="//www.everstray.com/cdn/QuickFrontend/SinriQF/dist/SinriQF-1.0.js"></script>

<!--Config-->
<script src="./static/config/api.js"></script>
<script src="./static/config/constants.js"></script>

<!--Plugins-->
<script src="./static/plugins/ajax.js"></script>

<!--Components-->
<script src="static/component/layout/index.js"></script>
<script src="static/component/layout/list.js"></script>
<script src="static/component/top-banner.js"></script>

<!--Pages-->
<script src="static/views/dashboard.js"></script>
<script src="static/views/config.js"></script>

<script src="static/views/management/index.js"></script>
<script src="static/views/management/permissions.js"></script>
<script src="static/views/management/databases/index.js"></script>
<script src="static/views/management/databases/create.js"></script>
<script src="static/views/management/databases/list.js"></script>
<script src="static/views/management/process.js"></script>

<script src="static/views/query.js"></script>
<script src="static/views/approvals.js"></script>
<script src="static/views/task.js"></script>
<script>
    const routes = [
        { path: '/', name: 'dashboardPage', component: DashboardPage },
        { path: '/approvals', name: 'approvalsPage', component: ApprovalsPage },
        { path: '/management', name: 'managementPage', component: ManagementPage,
            children: [
                {
                    path: 'databases',
                    name: 'databasesPage',
                    component: DatabasesPage,
                    children: [
                        {
                            path: '',
                            redirect: 'list'
                        },
                        {
                            path: 'list',
                            name: 'databaseListPage',
                            component: DatabaseListPage
                        },
                        {
                            path: 'create',
                            name: 'createDatabasePage',
                            component: CreateDatabasePage
                        }
                    ]
                },
                {
                    path: 'permissions',
                    name: 'permissionsPage',
                    component: PermissionsPage
                },
                {
                    path: 'process',
                    name: 'processPage',
                    component: ProcessPage
                }
            ]},
        { path: '/query', name: 'queryPage', component: QueryPage },
        { path: '/config', name: 'configPage', component: ConfigPage },
        { path: '/task', name: 'taskPage', component: TaskPage }
    ];
    const router = new VueRouter({
        routes
    });

    SinriQF.config.TokenName = 'database_hub_token';

    router.beforeEach((to, from, next) => {
        // 检测登录状态
        if (!SinriQF.cookies.getCookie(SinriQF.config.TokenName)) {
            window.location.href = 'login.html';
        }

        next()
    })

    new Vue({
        el: '#app',
        router,
        data: {},
        methods: {

        },
        mounted: function () {
            SinriQF.config.vueInstance = this;
        }
    });
</script>
</body>
</html>
